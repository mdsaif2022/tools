<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Multi OCR to Word Converter</title>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl p-8">
    <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">ðŸ“„ Multi OCR to Word Converter</h1>
    <input type="file" id="imageInput" accept="image/*" multiple class="block w-full mb-4 p-2 border border-gray-300 rounded" />
    <button onclick="startOCR()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full">Convert to Word</button>

    <div id="progress" class="mt-4 text-center text-sm text-gray-600 hidden">Processing...</div>

    <div id="downloadSection" class="mt-6 hidden">
      <textarea id="finalText" class="w-full h-64 p-4 border border-gray-300 rounded resize-none" readonly></textarea>
      <button onclick="downloadDoc()" class="mt-4 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Download Word File</button>
    </div>
  </div>

  <script>
    async function startOCR() {
      const input = document.getElementById('imageInput');
      const progress = document.getElementById('progress');
      const downloadSection = document.getElementById('downloadSection');
      const finalTextArea = document.getElementById('finalText');

      if (input.files.length < 1 || input.files.length > 40) {
        alert('Please upload between 1 to 40 images.');
        return;
      }

      progress.classList.remove('hidden');
      progress.innerText = `Processing ${input.files.length} image(s)...`;

      let allText = '';

      for (let i = 0; i < input.files.length; i++) {
        progress.innerText = `Processing image ${i + 1} of ${input.files.length}...`;

        const { data: { text } } = await Tesseract.recognize(input.files[i], 'eng+ben', {
          logger: m => console.log(m)
        });

        allText += `\n\n[Image ${i + 1}]\n${text.trim()}`;
      }

      finalTextArea.value = allText;
      progress.classList.add('hidden');
      downloadSection.classList.remove('hidden');
    }

    function downloadDoc() {
      const text = document.getElementById('finalText').value;
      const blob = new Blob(
        [`<html><body><pre>${text}</pre></body></html>`],
        { type: "application/msword" }
      );
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'Converted_Document.doc';
      a.click();
    }
  </script>
</body>
</html>
